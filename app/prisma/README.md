# Инструкция по работе с Prisma

## Этапы работы с миграциями

1. **Создайте или измените схему в `schema.prisma`.**
2. **Сгенерируйте миграцию** (после любого изменения схемы):
   ```sh
   npx prisma migrate dev --name <название_миграции>
   ```
   Например:
   ```sh
   npx prisma migrate dev --name init
   ```
   Эта команда создаст новую миграцию в папке `prisma/migrations` и применит её к базе данных.
3. **Сгенерируйте Prisma Client** (обычно команда выше делает это автоматически, но можно вручную):
   ```sh
   npx prisma generate
   ```
4. **Используйте Prisma Client в коде приложения.**

---

## Основные команды

- **Установка зависимостей** (после изменения package.json):
  ```sh
  npm install
  ```

- **Генерация Prisma Client**
  Запускайте после каждого изменения файла `schema.prisma`:
  ```sh
  npx prisma generate
  ```
  > **Примечание:** В результате выполнения этой команды автоматически генерируется Prisma Client, который помещается в папку `node_modules/@prisma/client`. Этот клиент используется в вашем коде для работы с базой данных.

- **Применение миграций к базе данных**
  ```sh
  npx prisma migrate deploy
  ```
  или для локальной разработки:
  ```sh
  npx prisma migrate dev
  ```

## Когда запускать `npx prisma generate`?
- После любого изменения файла `schema.prisma` (добавление/удаление/переименование моделей, полей, связей).
- После обновления версии Prisma или изменения настроек генерации клиента.
- Если не было изменений — повторно запускать не нужно.

## Где использовать Prisma Client?
- Импортируйте и используйте Prisma Client в вашем приложении:
  ```js
  import { PrismaClient } from '@prisma/client';
  const prisma = new PrismaClient();
  ```
- Prisma Client всегда берётся из папки `node_modules/@prisma/client`.

## Важно
- Не указывайте параметры `fields` и `references` в массивных полях моделей (например, `Message[]`). Эти параметры должны быть только на стороне, где есть внешний ключ.
- Все изменения схемы требуют повторной генерации клиента и, возможно, миграций.

---

Больше информации: https://www.prisma.io/docs 